---
type MediaItem = {
  title: string;
  url?: string;
  cover?: string;
  subtitle?: string;
  myRating?: number;
};

interface Props {
  item: MediaItem;
}

const { item } = Astro.props;
const stars = Math.max(0, Math.min(5, Math.round(item.myRating ?? 0)));
---

<li class="group h-full">
  {item.url ? (
    <a
      href={item.url}
      target="_blank"
      rel="noopener noreferrer"
      class="block h-full rounded-lg shadow-sm hover:-translate-y-1 hover:shadow-2xl hover:shadow-black/30 transition-all duration-300"
    >
      <div class="p-3 flex h-full flex-col">
        <div class="relative aspect-[2/3] overflow-hidden rounded-lg bg-black/5 dark:bg-white/5">
          {item.cover ? (
            <img
              src={item.cover}
              alt={item.title}
              loading="lazy"
              decoding="async"
              width="320"
              height="480"
              class="h-full w-full object-cover transition-transform duration-300 group-hover:scale-[1.02]"
            />
          ) : (
            <div class="h-full w-full flex items-center justify-center text-xs text-stone-500 dark:text-stone-400">
              No cover
            </div>
          )}
        </div>
        <div class="pt-3 space-y-2">
          <div
            class="text-xs font-semibold text-black/90 dark:text-white/90 leading-snug"
            style="display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;"
          >
            {item.title}
          </div>
          <div class="flex items-center gap-0.5 text-amber-300 dark:text-amber-200">
            {[1, 2, 3, 4, 5].map((star) => (
              <svg
                class="size-3"
                viewBox="0 0 20 20"
                fill={star <= stars ? "currentColor" : "none"}
                stroke="currentColor"
                stroke-width="1.4"
                aria-hidden="true"
              >
                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.286 3.96a1 1 0 0 0 .95.69h4.163c.969 0 1.371 1.24.588 1.81l-3.368 2.447a1 1 0 0 0-.364 1.118l1.287 3.96c.3.921-.755 1.688-1.54 1.118l-3.368-2.447a1 1 0 0 0-1.176 0l-3.368 2.447c-.784.57-1.838-.197-1.539-1.118l1.287-3.96a1 1 0 0 0-.364-1.118L2.048 9.387c-.784-.57-.38-1.81.588-1.81h4.163a1 1 0 0 0 .95-.69l1.3-3.96z" />
              </svg>
            ))}
            <span class="sr-only">{stars} out of 5</span>
          </div>
        </div>
      </div>
    </a>
  ) : (
    <div class="rounded-lg shadow-sm hover:shadow-2xl hover:shadow-black/30 p-3 flex h-full flex-col">
      <div class="relative aspect-[2/3] overflow-hidden rounded-lg bg-black/5 dark:bg-white/5">
        {item.cover ? (
          <img
            src={item.cover}
            alt={item.title}
            loading="lazy"
            decoding="async"
            width="320"
            height="480"
            class="h-full w-full object-cover transition-transform duration-300 group-hover:scale-[1.02]"
          />
        ) : (
          <div class="h-full w-full flex items-center justify-center text-xs text-stone-500 dark:text-stone-400">
            No cover
          </div>
        )}
      </div>
      <div class="pt-3 space-y-2">
        <div
          class="text-xs font-semibold text-black/90 dark:text-white/90 leading-snug"
          style="display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;"
        >
          {item.title}
        </div>
        <div class="flex items-center gap-0.5 text-amber-300 dark:text-amber-200">
          {[1, 2, 3, 4, 5].map((star) => (
            <svg
              class="size-3"
              viewBox="0 0 20 20"
              fill={star <= stars ? "currentColor" : "none"}
              stroke="currentColor"
              stroke-width="1.4"
              aria-hidden="true"
            >
              <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.286 3.96a1 1 0 0 0 .95.69h4.163c.969 0 1.371 1.24.588 1.81l-3.368 2.447a1 1 0 0 0-.364 1.118l1.287 3.96c.3.921-.755 1.688-1.54 1.118l-3.368-2.447a1 1 0 0 0-1.176 0l-3.368 2.447c-.784.57-1.838-.197-1.539-1.118l1.287-3.96a1 1 0 0 0-.364-1.118L2.048 9.387c-.784-.57-.38-1.81.588-1.81h4.163a1 1 0 0 0 .95-.69l1.3-3.96z" />
            </svg>
          ))}
          <span class="sr-only">{stars} out of 5</span>
        </div>
      </div>
    </div>
  )}
</li>
